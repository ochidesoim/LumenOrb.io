<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Trials of the Celestial River</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=IM+Fell+English&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'IM Fell English', serif;
            background-color: #1a1a1a;
            background-image: url('https://www.transparenttextures.com/patterns/old-wall.png');
            color: #e0d9c4;
        }
        .font-display {
            font-family: 'Cinzel Decorative', cursive;
        }
        .papyrus-bg {
            background-color: #f5eeda;
            color: #3a2d21;
            border: 2px solid #c9b89b;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .item-card {
            border: 1px solid #c9b89b;
            background-color: #e0d9c4;
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            text-align: center;
            padding: 0.75rem; /* p-3 */
            border-radius: 0.375rem; /* rounded-md */
        }
        .item-card:hover {
            transform: translateY(-5px);
            background-color: #fffbef;
        }
        .item-card.selected {
            background-color: #fde68a; /* A gold color */
            border-color: #ca8a04;
            transform: translateY(-5px);
        }
        .item-card.solved {
            background-color: #a7f3d0;
            border-color: #059669;
            opacity: 0.7;
            pointer-events: none;
        }
        .item-card.unselectable {
            opacity: 0.6;
            pointer-events: none;
            background-color: #d6d3d1;
        }
        .item-card h3 {
            font-family: 'Cinzel Decorative', cursive;
            font-weight: 700;
            color: #5a4a3a;
        }
        .hieroglyph-icon {
            width: 2.5rem; /* Increased size */
            height: 2.5rem;
            fill: #856d4b;
            margin: 0 auto 0.5rem auto; /* Center icon */
        }
        .progress-bar-fill {
            background: linear-gradient(90deg, #fde68a, #ca8a04);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <header class="py-6 px-8">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <a href="index.html" class="font-display text-3xl text-[#fde68a]">LumenOrb</a>
            <a href="page2.html" class="border border-[#c9b89b] text-[#856d4b] font-semibold py-2 px-6 rounded-lg hover:bg-[#c9b89b] hover:text-[#3a2d21] transition-all">
                &larr; Back to Mission
            </a>
        </div>
    </header>

    <div class="max-w-7xl mx-auto">
        <div class="text-center mb-8">
            <h1 class="font-display text-4xl md:text-6xl text-[#fde68a]">The Trials of the Celestial River</h1>
            <p class="text-xl mt-2">O, Sky Pharaoh! The heavens are in chaos. Build the Pyramid of Order by solving the Curses below.</p>
        </div>

        <div id="game-container" class="papyrus-bg p-6 rounded-lg flex flex-col items-center">
            <h2 class="font-display text-3xl text-center mb-6">The Pyramid of Order</h2>
            <div id="pyramid-container" class="w-full max-w-6xl space-y-4">
                <!-- Edicts (Solutions) Tiers -->
                <div id="edicts-tier-1" class="flex justify-center gap-4"></div>
                <div id="edicts-tier-2" class="flex justify-center gap-4"></div>
                <div id="edicts-tier-3" class="flex justify-center gap-4"></div>
                
                <!-- Curses (Problems) Base -->
                <div id="curses-base" class="flex flex-wrap justify-center gap-4 pt-4 border-t-4 border-[#c9b89b]"></div>
            </div>
        </div>

        <!-- Progress and Status -->
        <footer class="text-center mt-8 papyrus-bg p-4 rounded-lg">
            <h3 class="font-display text-2xl">Progress of Restoration</h3>
            <div class="w-full bg-[#c9b89b] rounded-full h-4 mt-2">
                <div id="progress-bar" class="progress-bar-fill h-4 rounded-full" style="width: 0%"></div>
            </div>
            <p id="status-message" class="mt-2 text-lg h-8">Select a Curse from the foundation to begin.</p>
        </footer>
    </div>
    
    <!-- SVG Icon Definitions (same as before) -->
    <svg class="hidden">
        <defs>
            <symbol id="icon-debris" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5-10-5-10 5zM12 14.5l-10-5 .5-.25 10 5 10-5 .5.25-10 5z"/></symbol>
            <symbol id="icon-cascade" viewBox="0 0 24 24"><path d="M3 3h18v2H3V3zm0 4h18v2H3V7zm0 4h18v2H3v-2zm0 4h18v2H3v-2zm0 4h18v2H3v-2z"/></symbol>
            <symbol id="icon-radiation" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></symbol>
            <symbol id="icon-weather" viewBox="0 0 24 24"><path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8-8 3.59-8-8 3.59 8 8 8zM13 7h-2v5.41l3.79 3.8 1.42-1.42L13 11.41V7z"/></symbol>
            <symbol id="icon-charge" viewBox="0 0 24 24"><path d="M7 2v11h3v9l7-12h-4l4-8z"/></symbol>
            <symbol id="icon-degradation" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM8 11h8v2H8z"/></symbol>
            <symbol id="icon-health" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></symbol>
            <symbol id="icon-congestion" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></symbol>
            <symbol id="icon-explosion" viewBox="0 0 24 24"><path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18c-4.41 0-8-3.59-8-8s-3.59-8-8-8-8 3.59-8-8 3.59 8 8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></symbol>
            <symbol id="icon-reentry" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></symbol>
        </defs>
    </svg>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const edictsTier1 = document.getElementById('edicts-tier-1');
            const edictsTier2 = document.getElementById('edicts-tier-2');
            const edictsTier3 = document.getElementById('edicts-tier-3');
            const cursesBase = document.getElementById('curses-base');

            const progressBar = document.getElementById('progress-bar');
            const statusMessage = document.getElementById('status-message');

            const gameData = [
                { id: 1, curse: 'Plague of Shards', curse_desc: 'Countless fragments drift, a threat to all vessels.', edict: 'The All-Seeing Eye', edict_desc: 'A divine gaze that tracks every shard.', icon: 'icon-debris' },
                { id: 2, curse: 'Unraveling Skies', curse_desc: 'A single impact creates a cascade of destruction.', edict: 'Edict of Timely Demise', edict_desc: 'Mandate that all vessels de-orbit within 25 years.', icon: 'icon-cascade' },
                { id: 3, curse: 'Ra\'s Unseen Fury', curse_desc: 'Cosmic rays and solar storms damage sacred electronics.', edict: 'Aegis of the Sun God', edict_desc: 'Improve shielding with hydrogen-rich composites.', icon: 'icon-radiation' },
                { id: 4, curse: 'Whispers of Solar Winds', curse_desc: 'Flares from the sun cause unpredictable drag and orbital decay.', edict: 'Scrying the Solar Flares', edict_desc: 'Develop better real-time space weather forecasting.', icon: 'icon-weather' },
                { id: 5, curse: 'The Spark of Ruin', curse_desc: 'Electrostatic discharges from the void can cripple vital systems.', edict: 'Decree of Balance', edict_desc: 'Apply anti-charging coatings and proper grounding.', icon: 'icon-charge' },
                { id: 6, curse: 'The Sun\'s Gnawing Bite', curse_desc: 'Atomic oxygen and UV rays erode and weaken vessel surfaces.', edict: 'Blessing of Durability', edict_desc: 'Enforce new design standards for material resilience.', icon: 'icon-degradation' },
                { id: 7, curse: 'The Withering of the Vessel', curse_desc: 'Microgravity and radiation harm the mortal form of astronauts.', edict: 'The Pharaoh\'s Health', edict_desc: 'Mandate strict exercise protocols and medical monitoring.', icon: 'icon-health' },
                { id: 8, curse: 'The Crowded Heavens', curse_desc: 'Mega-constellations of satellites increase the chance of collision.', edict: 'Scrolls of Cooperation', edict_desc: 'Foster public-private partnerships for safe deployment.', icon: 'icon-congestion' },
                { id: 9, curse: 'The Shattered Star', curse_desc: 'Anti-satellite tests create sudden, dense fields of debris.', edict: 'Harpoon of Horus', edict_desc: 'Deploy Active Debris Removal (ADR) technologies.', icon: 'icon-explosion' },
                { id: 10, curse: 'The Falling Scourge', curse_desc: 'Uncontrolled re-entries can drop dangerous debris on Earth.', edict: 'The Celestial Navigator', edict_desc: 'Create a global system for space traffic management.', icon: 'icon-reentry' }
            ];

            let selectedCurse = null;
            let solvedCount = 0;

            function createCard(item, type) {
                const isCurse = type === 'curse';
                const title = isCurse ? item.curse : item.edict;
                const desc = isCurse ? item.curse_desc : item.edict_desc;
                
                return `
                    <div class="item-card w-full sm:w-[48%] md:w-[30%] lg:w-[18%]" data-id="${item.id}" data-type="${type}">
                        <svg class="hieroglyph-icon"><use href="#${item.icon}"></use></svg>
                        <div class="flex-grow">
                            <h3 class="text-base">${title}</h3>
                            <p class="text-xs text-[#6d5b4b] mt-1">${desc}</p>
                        </div>
                    </div>
                `;
            }
            
            // Shuffle edicts and distribute them into tiers
            const shuffledEdicts = [...gameData].sort(() => Math.random() - 0.5);
            shuffledEdicts.slice(0, 2).forEach(item => edictsTier1.innerHTML += createCard(item, 'edict'));
            shuffledEdicts.slice(2, 5).forEach(item => edictsTier2.innerHTML += createCard(item, 'edict'));
            shuffledEdicts.slice(5, 10).forEach(item => edictsTier3.innerHTML += createCard(item, 'edict'));

            // Curses are the foundation
            gameData.forEach(item => {
                cursesBase.innerHTML += createCard(item, 'curse');
            });

            const edictCards = document.querySelectorAll('[data-type="edict"]');
            edictCards.forEach(card => card.classList.add('unselectable'));

            document.getElementById('game-container').addEventListener('click', (e) => {
                const card = e.target.closest('.item-card');
                if (!card || card.classList.contains('solved') || card.classList.contains('unselectable')) return;

                const id = card.dataset.id;
                const type = card.dataset.type;

                if (type === 'curse') {
                    if (selectedCurse) selectedCurse.classList.remove('selected');
                    selectedCurse = card;
                    card.classList.add('selected');
                    statusMessage.textContent = 'A Curse is chosen. Now, find the Sacred Edict from the pyramid above.';
                    edictCards.forEach(c => {
                        if (!c.classList.contains('solved')) {
                            c.classList.remove('unselectable')
                        }
                    });
                } else if (type === 'edict' && selectedCurse) {
                    if (selectedCurse.dataset.id === id) {
                        // Correct Match
                        selectedCurse.classList.add('solved');
                        card.classList.add('solved');
                        selectedCurse.classList.remove('selected');
                        
                        solvedCount++;
                        progressBar.style.width = `${(solvedCount / gameData.length) * 100}%`;
                        statusMessage.textContent = 'Correct! A block of the pyramid is secured.';

                        selectedCurse = null;
                        edictCards.forEach(c => c.classList.add('unselectable'));

                        if (solvedCount === gameData.length) {
                            statusMessage.textContent = 'The Pyramid of Order is complete! You have won, O great Pharaoh!';
                        }

                    } else {
                        // Incorrect Match
                        statusMessage.textContent = 'That Edict does not counter the chosen Curse. Try again.';
                        card.classList.add('bg-red-200', 'border-red-500');
                        setTimeout(() => {
                           card.classList.remove('bg-red-200', 'border-red-500');
                        }, 800);
                    }
                }
            });
        });
    </script>
</body>
</html>

